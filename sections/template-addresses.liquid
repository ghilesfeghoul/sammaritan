<section class="pt-7 pb-12">
  <div class="container">
    <div class="row">
      <div class="col-12 text-center">

        <!-- Heading -->
        <h3 class="mb-10">My Addresses</h3>

      </div>
    </div>
    <div class="row">
      <div class="col-12 col-md-3">

        <!-- Nav -->
        <nav class="mb-10 mb-md-0">
          <div class="list-group list-group-sm list-group-strong list-group-flush-x">
            <a class="list-group-item list-group-item-action dropend-toggle " href="account-orders.html">
              Orders
            </a>
            <a class="list-group-item list-group-item-action dropend-toggle " href="account-wishlist.html">
              Widhlist
            </a>
            <a class="list-group-item list-group-item-action dropend-toggle " href="account-personal-info.html">
              Personal Info
            </a>
            <a class="list-group-item list-group-item-action dropend-toggle active" href="account-address.html">
              Addresses
            </a>
            <a class="list-group-item list-group-item-action dropend-toggle " href="account-payment.html">
              Payment Methods
            </a>
            <a class="list-group-item list-group-item-action dropend-toggle" href="#!">
              Logout
            </a>
          </div>
        </nav>

      </div>
      <div class="col-12 col-md-9 col-lg-8 offset-lg-1">
        <div class="row">
          {% paginate customer.addresses by 10 %}
            {% for address in customer.addresses %}
              <div class="col-12 col-lg-6">

                <!-- Card -->
                <div class="card card-lg bg-light mb-8">

                  <div class="card-body">
                    {% if address == customer.default_address %}
                      <span class="rounded-pill bg-dark text-white p-2">Default</span>
                    {% endif %}
                    <!-- Text -->
                    <p class="text-muted mb-0 py-3">
                      {{ address | format_address }}
                    </p>

                    <!-- Action -->
                    <div class="card-action card-action-end">

                      <!-- Button -->
                      <a class="btn btn-xs btn-circle btn-white-primary" href="account-address-edit.html">
                        <i class="fe fe-edit-2"></i>
                      </a>

                      <!-- Button -->
                      <button
                        data-url="{{ address.url }}"
                        data-delete-address
                        class="btn btn-xs btn-circle btn-white-primary">
                        <i class="fe fe-x"></i>
                      </button>
                      <form method="post" action="{{ address.url }}">
                        <input
                          type="hidden"
                          name="_method"
                          value="delete">
                      </form>

                    </div>

                  </div>
                </div>

              </div>
            {% endfor %}
          {% endpaginate %}
          <div class="col-12">


            <!-- Button -->
            <a class="btn w-100 btn-lg btn-outline-border" href="account-address-edit.html">
              Add Address
              <i class="fe fe-plus"></i>
            </a>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  class CustomerAddress {
    constructor() {
      this.initDeleteAddressButtons();
    }

    initDeleteAddressButtons() {
      const deleteButtons = document.querySelectorAll("button[data-delete-address]");
      if (deleteButtons.length < 1) 
        return;
      



      deleteButtons.forEach(button => {
        button.addEventListener("click", function(e) {
          var url = this.dataset.url;
          console.log(url);
          var confirmation = window.confirm("Do you really wish to delete this address?");

          if (confirmation) {
            document.querySelector(`form[action="${url}"]`).submit();
          }
        })
      })
    }
  }

  const customerAddress = new CustomerAddress();
</script>